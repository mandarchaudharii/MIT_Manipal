REM   Script: WEEK 4
REM   DBS LAB WEEK 4 CODES

4.1

SELECT * FROM CLIENT;

4.2

SELECT NAME,PHONE,EMAIL FROM EMP WHERE DESIGNATION='DEVELOPER';

4.3

SELECT NAME FROM EMP WHERE REPORTS_TO=106;

4.4

SELECT NAME,EMAIL FROM EMP WHERE DESIGNATION='TECHNICAL HEAD' AND QUALIFICATION='BTECH';

4.5

SELECT NAME FROM EMP WHERE SALARY BETWEEN 100000 AND 200000;

SELECT NAME FROM EMP WHERE SALARY >=100000 AND SALARY<=200000;

4.6

SELECT SKILLNAME FROM SKILL NATURAL JOIN EMP_SKILL WHERE EMPNO=101;

4.7

SELECT SKILLID FROM SKILL NATURAL JOIN EMP_SKILL WHERE EMPNO=101;

4.8

SELECT EMPCODE FROM WORK_EXP WHERE CLIENTID IN ('C1','C2') AND RATING IN ('A','B');

4.9

SELECT NAME FROM EMP NATURAL JOIN WORK_EXP WHERE CLIENTID='C2' AND RATING ='B';

4.10

SELECT COUNT(DEP_NAME) FROM FAMILY_DEPENDENTS FD JOIN EMP E ON FD.EMPNO=E.EMPCODE WHERE NAME='RAVI';

4.11

SELECT NAME, DESIGNATION, SALARY*12 AS ANNUAL_SALARY FROM EMP;

4.12

SELECT NAME, DEP_NAME FROM EMP E LEFT JOIN FAMILY_DEPENDENTS FD ON E.EMPCODE=FD.EMPNO;

4.13

SELECT NAME,PRJ_NAME FROM PRJ_DETAILS PD JOIN EMP E ON PD.LEAD_BY_EMPCODE=E.EMPCODE WHERE END_DATE>=ACTUAL_END_DATE AND BUDGET_ALLOCATED>=ACTUAL_BUDGET;

4.14

SELECT NAME,SALARY,P.* FROM EMP E JOIN PAY_CHECK P ON E.EMPCODE=P.EMPCODE WHERE EXTRACT(MONTH FROM PAY_DATE)=3;

4.15

SELECT E.NAME,P.NAME AS REPORTS_TO , P.PHONE FROM EMP E JOIN EMP P ON E.EMPCODE=P.EMPCODE WHERE P.EMPCODE=E.REPORTS_TO;

4.16

SELECT * FROM PRJ_DETAILS ORDER BY ACTUAL_END_DATE DESC

4.17

SELECT NAME,SKILLNAME FROM EMP E JOIN EMP_SKILL ES ON E.EMPCODE=ES.EMPNO JOIN SKILL S ON ES.SKILLID=S.SKILLID ORDER BY EMPNO, SKILL_EXPERIENCE DESC;

4.18

SELECT NAME,DEP_NAME,AGE FROM EMP E JOIN FAMILY_DEPENDENTS F ON E.EMPCODE=F.EMPNO WHERE RELATIONSHIP='SON' ORDER BY NAME,AGE DESC;

4.19

SELECT NAME,PRJ_NAME FROM EMP E JOIN WORK_EXP W ON E.EMPCODE=W.EMPCODE JOIN PRJ_DETAILS P ON W.PRJID=P.PRJID ORDER BY NAME, P.PRJ_NAME DESC;

4.20

SELECT NAME FROM EMP E JOIN WORK_EXP W ON E.EMPCODE=W.EMPCODE JOIN PRJ_DETAILS P ON W.PRJID=P.PRJID WHERE PRJ_NAME='SPYDER' 
UNION 
SELECT NAME FROM EMP E JOIN WORK_EXP W ON E.EMPCODE=W.EMPCODE JOIN PRJ_DETAILS P ON W.PRJID=P.PRJID WHERE PRJ_NAME='APOLLO';

4.21

SELECT NAME FROM EMP E JOIN EMP_SKILL ES ON E.EMPCODE=ES.EMPNO JOIN SKILL S ON ES.SKILLID=S.SKILLID WHERE SKILLNAME='Oracle' 
INTERSECT 
SELECT NAME FROM EMP E JOIN EMP_SKILL ES ON E.EMPCODE=ES.EMPNO JOIN SKILL S ON ES.SKILLID=S.SKILLID WHERE SKILLNAME='AZURE';

4.22

SELECT DISTINCT(NAME) FROM EMP E JOIN WORK_EXP W ON E.EMPCODE=W.EMPCODE JOIN PRJ_DETAILS P ON W.PRJID=P.PRJID 
MINUS 
SELECT DISTINCT(NAME) FROM EMP E JOIN WORK_EXP W ON E.EMPCODE=W.EMPCODE JOIN PRJ_DETAILS P ON W.PRJID=P.PRJID WHERE P.PRJ_NAME='JUPITOR';

4.23

SELECT NAME FROM EMP WHERE REPORTS_TO IS NULL;

4.24

SELECT NAME,EMAIL FROM EMP WHERE NAME LIKE 'Ra%';

4.25

SELECT PRJ_NAME FROM PRJ_DETAILS WHERE START_DATE BETWEEN '1-JAN-2020' AND '31-DEC-2020';

4.26

SELECT DISTINCT(NAME) FROM EMP E JOIN EMP_SKILL S ON E.EMPCODE=S.EMPNO WHERE SKILLID IN (SELECT SKILLID FROM EMP_SKILL WHERE EMPNO=101);

